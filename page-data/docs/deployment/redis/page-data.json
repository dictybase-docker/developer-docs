{"componentChunkName":"component---node-modules-smooth-doc-src-templates-doc-js","path":"/docs/deployment/redis/","result":{"data":{"mdx":{"fields":{"pageType":"doc","title":"Redis","editLink":""},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Redis\",\n  \"section\": \"Deployment\",\n  \"order\": 6\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"redis\"\n  }, mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#redis\",\n    \"aria-hidden\": true,\n    \"className\": \"anchor\"\n  }, mdx(\"svg\", {\n    \"aria-hidden\": \"true\",\n    height: \"16\",\n    version: \"1.1\",\n    viewBox: \"0 0 16 16\",\n    width: \"16\"\n  }, mdx(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Redis\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://redis.io\"\n  }, \"Redis\"), \" will be used for caching entries and it is installed from \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://hub.kubeapps.com/charts/bitnami/redis\"\n  }, \"this chart\"), \".\"), mdx(\"h2\", {\n    \"id\": \"checking-redis-data-in-the-cluster\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#checking-redis-data-in-the-cluster\",\n    \"aria-hidden\": true,\n    \"className\": \"anchor\"\n  }, mdx(\"svg\", {\n    \"aria-hidden\": \"true\",\n    height: \"16\",\n    version: \"1.1\",\n    viewBox: \"0 0 16 16\",\n    width: \"16\"\n  }, mdx(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Checking Redis data in the cluster\"), mdx(\"p\", null, \"Use this process to check the status of data in the redis instance before and after any kind of upgrade.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Get a shell in kubernetes cluster.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"kubectl run --rm -it --restart=Never -n dictybase redis-backup --image=redis:4-alpine3.10 /bin/sh\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Login to the database\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"$_> redis-cli -h $REDIS_MASTER_SERVICE_HOST -p $REDIS_MASTER_SERVICE_PORT\\nx.x.x.x:6379>\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"List keys\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"x.x.x.x:6379> KEYS *\\n\")), mdx(\"h2\", {\n    \"id\": \"upgrading-from-an-existing-version\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#upgrading-from-an-existing-version\",\n    \"aria-hidden\": true,\n    \"className\": \"anchor\"\n  }, mdx(\"svg\", {\n    \"aria-hidden\": \"true\",\n    height: \"16\",\n    version: \"1.1\",\n    viewBox: \"0 0 16 16\",\n    width: \"16\"\n  }, mdx(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Upgrading from an existing version\"), mdx(\"blockquote\", null, mdx(\"h4\", {\n    parentName: \"blockquote\",\n    \"id\": \"its-always-recommended-to-upgrade-helm-if-possible\"\n  }, mdx(\"a\", {\n    parentName: \"h4\",\n    \"href\": \"#its-always-recommended-to-upgrade-helm-if-possible\",\n    \"aria-hidden\": true,\n    \"className\": \"anchor\"\n  }, mdx(\"svg\", {\n    \"aria-hidden\": \"true\",\n    height: \"16\",\n    version: \"1.1\",\n    viewBox: \"0 0 16 16\",\n    width: \"16\"\n  }, mdx(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"It's always recommended to \", mdx(\"a\", {\n    parentName: \"h4\",\n    \"href\": \"/developer-docs/deployment/helm\"\n  }, \"upgrade helm\"), \" if possible.\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add helm repository for redis\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"$_> helm repo add bitnami https://charts.bitnami.com/bitnami\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Check the current version of redis installed in the cluster ...\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"$_> helm ls redis\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"If the chart version is \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"<7.0.0\"), \" then it has to be upgraded to a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"8.x.x\"), \"\\nversion. The standard \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"helm upgrade\"), \" is not going to work, so the old chart\\nand has to removed and then the new chart has to be installed. The\\naccompanying \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"pvc(PersistentVolumeClaim)\"), \" will not be removed and so no data\\nwill be destroyed with this upgrade. Make sure to check status of redis data after\\nthis upgrade. Use the following \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"helm value\"), \" file as save it as \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"dev.yaml\"), \".\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"cluster:\\n  enabled: true\\n  slaveCount: 1\\nusePassword: false\\nserviceAccount:\\n  create: true\\n  name: redis\\nrbac:\\n  create: true\\n  role:\\n    rules:\\n      - apiGroups:\\n          - extensions\\n        resources:\\n          - podsecuritypolicies\\n        verbs:\\n          - use\\n        resourceNames:\\n          - gce.unprivileged\\nslave:\\n  persistence:\\n    enabled: true\\n    path: /bitnami/redis/data\\n    storageClass: fast\\n    size: 15Gi\\nmaster:\\n  persistence:\\n    enabled: true\\n    path: /bitnami/redis/data\\n    storageClass: fast\\n    size: 15Gi\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"$_> helm delete redis --purge\\n$_> helm install --name redis --namespace dictybase -f dev.yaml bitnami/redis --version 8.1.5\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Then simply upgrade to the 9.x and finally to the latest 10.x version. Though it is\\nnot really important to check the data after these upgrades, however make sure that the redis\\ninstance is in running state before performing the helm based upgrade.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"$_> helm upgrade redis  --namespace dictybase  -f dev.yaml bitnami/redis --version 9.5.5\\n$_> helm upgrade redis  --namespace dictybase  -f dev.yaml bitnami/redis --version 10.6.12\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The chart version \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"10.6.12\"), \" will install redis \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"5.0.9\"), \".\")), mdx(\"h2\", {\n    \"id\": \"fresh-install\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#fresh-install\",\n    \"aria-hidden\": true,\n    \"className\": \"anchor\"\n  }, mdx(\"svg\", {\n    \"aria-hidden\": \"true\",\n    height: \"16\",\n    version: \"1.1\",\n    viewBox: \"0 0 16 16\",\n    width: \"16\"\n  }, mdx(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Fresh install\"), mdx(\"p\", null, \"Use the above helm value file.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"$_> helm install redis  --namespace dictybase  -f dev.yaml bitnami/redis --version 10.6.12\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#redis","title":"Redis","items":[{"url":"#checking-redis-data-in-the-cluster","title":"Checking Redis data in the cluster"},{"url":"#upgrading-from-an-existing-version","title":"Upgrading from an existing version"},{"url":"#fresh-install","title":"Fresh install"}]}]}}},"pageContext":{"id":"f5f57a33-32c1-55a3-9f2b-3f26a96b5338"}},"staticQueryHashes":["1022386572","1122327541","1339625561","2140385554","3442269102","3597609067"]}